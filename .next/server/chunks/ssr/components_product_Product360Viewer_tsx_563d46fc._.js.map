{"version":3,"sources":["../../../../components/product/Product360Viewer.tsx"],"sourcesContent":["'use client';\n\n/**\n * 360¬∞ PRODUCT VIEWER\n * Interactive 360-degree product viewer with touch controls\n */\n\nimport { useState, useRef, useEffect } from 'react';\nimport { motion, PanInfo } from 'framer-motion';\n\ninterface Product360ViewerProps {\n  images: string[]; // Array of 360¬∞ images (36 images for smooth rotation)\n  productName: string;\n  autoRotate?: boolean;\n  rotationSpeed?: number;\n}\n\nexport default function Product360Viewer({\n  images,\n  productName,\n  autoRotate = false,\n  rotationSpeed = 0.5,\n}: Product360ViewerProps) {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [isDragging, setIsDragging] = useState(false);\n  const [startX, setStartX] = useState(0);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);\n  const autoRotateRef = useRef<ReturnType<typeof setInterval> | null>(null);\n\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n      setPrefersReducedMotion(mediaQuery.matches);\n    }\n  }, []);\n\n  // Auto-rotate\n  useEffect(() => {\n    if (autoRotate && !isDragging && !prefersReducedMotion) {\n      autoRotateRef.current = setInterval(() => {\n        setCurrentIndex((prev) => (prev + 1) % images.length);\n      }, 100 / rotationSpeed);\n      return () => {\n        if (autoRotateRef.current) {\n          clearInterval(autoRotateRef.current);\n          autoRotateRef.current = null;\n        }\n      };\n    }\n  }, [autoRotate, isDragging, images.length, rotationSpeed, prefersReducedMotion]);\n\n  const handleDragStart = (event: MouseEvent | TouchEvent | PointerEvent, info: PanInfo) => {\n    setIsDragging(true);\n    setStartX(info.point.x);\n  };\n\n  const handleDrag = (event: MouseEvent | TouchEvent | PointerEvent, info: PanInfo) => {\n    if (!isDragging) return;\n    \n    const deltaX = info.point.x - startX;\n    const sensitivity = 2;\n    const newIndex = Math.round(\n      (currentIndex + (deltaX / sensitivity)) % images.length\n    );\n    \n    if (newIndex >= 0 && newIndex < images.length) {\n      setCurrentIndex(newIndex);\n    }\n  };\n\n  const handleDragEnd = () => {\n    setIsDragging(false);\n  };\n\n  const handlePrevious = () => {\n    setCurrentIndex((prev) => (prev - 1 + images.length) % images.length);\n  };\n\n  const handleNext = () => {\n    setCurrentIndex((prev) => (prev + 1) % images.length);\n  };\n\n  // Generate images if not provided (placeholder)\n  const displayImages = images.length > 0 \n    ? images \n    : Array.from({ length: 36 }, (_, i) => `/images/360/product-${i + 1}.jpg`);\n\n  return (\n    <div className=\"relative w-full h-[600px] bg-black rounded-2xl overflow-hidden border border-gray-800\">\n      <motion.div\n        ref={containerRef}\n        className=\"relative w-full h-full cursor-grab active:cursor-grabbing\"\n        drag=\"x\"\n        dragConstraints={{ left: 0, right: 0 }}\n        onDragStart={handleDragStart}\n        onDrag={handleDrag}\n        onDragEnd={handleDragEnd}\n        whileDrag={{ cursor: 'grabbing' }}\n      >\n        {/* 360¬∞ Image */}\n        <motion.img\n          src={displayImages[currentIndex]}\n          alt={`${productName} - View ${currentIndex + 1}`}\n          className=\"w-full h-full object-cover\"\n          animate={{ opacity: 1 }}\n          transition={{ duration: 0.1 }}\n          draggable={false}\n        />\n\n        {/* Loading placeholder if image fails */}\n        <div className=\"absolute inset-0 flex items-center justify-center bg-gray-900\">\n          <div className=\"text-white text-center\">\n            <div className=\"text-4xl mb-4\">‚ö°</div>\n            <p>360¬∞ View</p>\n            <p className=\"text-sm text-gray-400 mt-2\">Drag or swipe to rotate</p>\n          </div>\n        </div>\n      </motion.div>\n\n      {/* Controls */}\n      <div className=\"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center gap-4 bg-black/80 backdrop-blur-sm px-6 py-3 rounded-full\">\n        <button\n          onClick={handlePrevious}\n          className=\"w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center text-white transition-all\"\n          aria-label=\"Previous view\"\n        >\n          ‚Üê\n        </button>\n        \n        <div className=\"flex gap-1\">\n          {Array.from({ length: Math.min(displayImages.length, 12) }).map((_, i) => {\n            const index = Math.floor((i / 12) * displayImages.length);\n            return (\n              <div\n                key={i}\n                className={`w-2 h-2 rounded-full transition-all ${\n                  Math.abs(currentIndex - index) < 3\n                    ? 'bg-brand-gold w-4'\n                    : 'bg-white/30'\n                }`}\n              />\n            );\n          })}\n        </div>\n        \n        <button\n          onClick={handleNext}\n          className=\"w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center text-white transition-all\"\n          aria-label=\"Next view\"\n        >\n          ‚Üí\n        </button>\n      </div>\n\n      {/* Touch Instructions */}\n      <div className=\"absolute top-4 right-4 bg-black/80 backdrop-blur-sm px-4 py-2 rounded-lg text-white text-sm\">\n        <p>üëÜ Drag to rotate</p>\n        <p className=\"text-xs text-gray-400 mt-1\">or use buttons</p>\n      </div>\n\n      {/* Fullscreen Button */}\n      <button\n        onClick={() => {\n          if (containerRef.current?.requestFullscreen) {\n            containerRef.current.requestFullscreen();\n          }\n        }}\n        className=\"absolute top-4 left-4 bg-black/80 backdrop-blur-sm px-4 py-2 rounded-lg text-white hover:bg-black/90 transition-all\"\n        aria-label=\"Fullscreen\"\n      >\n        ‚õ∂ Fullscreen\n      </button>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}