/**
 * PERKINS GENERATOR ERROR CODES DATABASE
 * Comprehensive fault codes for Perkins diesel engines
 * Includes 400, 1100, 2200, 2800, 4000 series
 * Updated: January 2026
 */

export interface PerkinsErrorCode {
  code: string;
  spn?: number;
  fmi?: number;
  brand: 'Perkins';
  model?: string;
  category: string;
  severity: 'info' | 'warning' | 'critical' | 'emergency';
  title: string;
  description: string;
  symptoms: string[];
  causes: string[];
  solution: string;
  parts?: string[];
  tools?: string[];
  estimatedTime?: string;
  estimatedCost?: string;
}

export const PERKINS_ERROR_CODES: PerkinsErrorCode[] = [
  // ===== SPN-BASED CODES =====
  {
    code: 'SPN-100',
    spn: 100,
    fmi: 1,
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Oil Pressure',
    severity: 'emergency',
    title: 'Engine Oil Pressure - Critically Low',
    description: 'CRITICAL: Engine oil pressure has dropped below safe operating level.',
    symptoms: ['Oil pressure warning', 'Engine knock', 'Shutdown', 'Alarm sounding'],
    causes: ['Low oil level', 'Oil pump failure', 'Blocked filter', 'Bearing wear', 'Oil leak'],
    solution: 'STOP ENGINE IMMEDIATELY. Check oil level. Inspect for leaks. Do NOT restart.',
    parts: ['Engine oil', 'Oil filter', 'Oil pump'],
    tools: ['Oil pressure gauge'],
    estimatedTime: '1-8+ hours',
    estimatedCost: '$50-$5000+'
  },
  {
    code: 'SPN-100-3',
    spn: 100,
    fmi: 3,
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Oil Pressure',
    severity: 'warning',
    title: 'Oil Pressure Sensor - Voltage High',
    description: 'Oil pressure sensor circuit showing abnormally high voltage.',
    symptoms: ['Oil pressure gauge maxed', 'Unable to read actual pressure'],
    causes: ['Failed sensor', 'Wiring short', 'Connector issue'],
    solution: 'Verify actual pressure with mechanical gauge. Check sensor wiring.',
    parts: ['Oil pressure sensor'],
    tools: ['Mechanical gauge', 'Multimeter'],
    estimatedTime: '30 min - 1 hour',
    estimatedCost: '$30-$150'
  },
  {
    code: 'SPN-100-4',
    spn: 100,
    fmi: 4,
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Oil Pressure',
    severity: 'warning',
    title: 'Oil Pressure Sensor - Voltage Low',
    description: 'Oil pressure sensor circuit showing abnormally low voltage.',
    symptoms: ['Zero oil pressure reading', 'Warning light on'],
    causes: ['Failed sensor', 'Open circuit', 'Ground issue'],
    solution: 'Verify actual pressure. Check wiring continuity. Replace sensor.',
    parts: ['Oil pressure sensor'],
    tools: ['Mechanical gauge', 'Multimeter'],
    estimatedTime: '30 min - 1 hour',
    estimatedCost: '$30-$150'
  },
  {
    code: 'SPN-110',
    spn: 110,
    fmi: 0,
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Coolant Temperature',
    severity: 'emergency',
    title: 'Coolant Temperature - Critically High',
    description: 'CRITICAL: Engine coolant temperature dangerously high.',
    symptoms: ['High temp warning', 'Steam/boiling', 'Engine derate/shutdown'],
    causes: ['Low coolant', 'Failed thermostat', 'Blocked radiator', 'Water pump failure'],
    solution: 'STOP ENGINE. Allow to cool. Check coolant level. Inspect cooling system.',
    parts: ['Coolant', 'Thermostat', 'Water pump'],
    tools: ['IR thermometer', 'Pressure tester'],
    estimatedTime: '1-8+ hours',
    estimatedCost: '$50-$3000'
  },
  {
    code: 'SPN-110-16',
    spn: 110,
    fmi: 16,
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Coolant Temperature',
    severity: 'warning',
    title: 'Coolant Temperature - High Warning',
    description: 'Engine coolant temperature above normal operating range.',
    symptoms: ['Temp gauge rising', 'Fan running', 'Possible derate'],
    causes: ['Low coolant', 'Cooling restriction', 'High ambient', 'High load'],
    solution: 'Reduce load. Check coolant level. Inspect radiator.',
    parts: ['Coolant', 'Radiator'],
    tools: ['IR thermometer'],
    estimatedTime: '30 min - 4 hours',
    estimatedCost: '$20-$500'
  },
  {
    code: 'SPN-157',
    spn: 157,
    fmi: 18,
    brand: 'Perkins',
    model: 'Common Rail',
    category: 'Fuel Pressure',
    severity: 'critical',
    title: 'Fuel Rail Pressure - Low',
    description: 'Fuel injection rail pressure below required level.',
    symptoms: ['Low power', 'Hard starting', 'White smoke', 'Stalling'],
    causes: ['Fuel restriction', 'Failed lift pump', 'Air in system', 'Worn high pressure pump'],
    solution: 'Check fuel level. Replace filters. Bleed system. Test pumps.',
    parts: ['Fuel filters', 'Lift pump', 'High pressure pump'],
    tools: ['Fuel pressure gauge', 'Perkins EST'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$50-$2000'
  },
  {
    code: 'SPN-190',
    spn: 190,
    fmi: 0,
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Engine Speed',
    severity: 'emergency',
    title: 'Engine Overspeed',
    description: 'CRITICAL: Engine RPM exceeded maximum safe speed.',
    symptoms: ['High engine noise', 'Emergency shutdown', 'Overspeed alarm'],
    causes: ['Governor failure', 'Fuel runaway', 'Load rejection'],
    solution: 'DO NOT RESTART. Inspect governor and fuel system.',
    parts: ['Governor', 'Fuel system'],
    tools: ['Perkins EST', 'Tachometer'],
    estimatedTime: '4-12 hours',
    estimatedCost: '$500-$5000'
  },
  {
    code: 'SPN-190-8',
    spn: 190,
    fmi: 8,
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Engine Speed',
    severity: 'critical',
    title: 'Engine Speed Sensor - No Signal',
    description: 'ECM not receiving signal from crankshaft position sensor.',
    symptoms: ['No start', 'Stalling', 'No RPM reading'],
    causes: ['Failed sensor', 'Wiring damage', 'Sensor gap'],
    solution: 'Check sensor resistance and gap. Inspect wiring.',
    parts: ['Speed sensor'],
    tools: ['Multimeter', 'Feeler gauge'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$50-$250'
  },
  // ===== P-CODE FORMAT (OBD-Style) =====
  {
    code: 'P0087',
    brand: 'Perkins',
    model: 'Common Rail',
    category: 'Fuel System',
    severity: 'critical',
    title: 'Fuel Rail Pressure Too Low',
    description: 'Fuel system pressure below minimum required.',
    symptoms: ['Hard starting', 'Power loss', 'Rough running'],
    causes: ['Fuel restriction', 'Pump failure', 'Injector leak'],
    solution: 'Check fuel supply. Test high pressure pump. Check injector back-leakage.',
    parts: ['Fuel filters', 'High pressure pump', 'Injectors'],
    tools: ['Fuel pressure gauge', 'Perkins EST'],
    estimatedTime: '1-6 hours',
    estimatedCost: '$100-$3000'
  },
  {
    code: 'P0088',
    brand: 'Perkins',
    model: 'Common Rail',
    category: 'Fuel System',
    severity: 'critical',
    title: 'Fuel Rail Pressure Too High',
    description: 'Fuel system pressure above safe limits.',
    symptoms: ['Hard running', 'Injector noise', 'Possible damage'],
    causes: ['Failed pressure regulator', 'Blocked return', 'Faulty pump'],
    solution: 'Check pressure regulator. Inspect return line. Test pump.',
    parts: ['Pressure regulator', 'Return lines'],
    tools: ['Fuel pressure gauge', 'Perkins EST'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$100-$1500'
  },
  {
    code: 'P0107',
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Intake Air',
    severity: 'warning',
    title: 'MAP Sensor - Low Input',
    description: 'Manifold Absolute Pressure sensor reading low.',
    symptoms: ['Reduced power', 'Poor fuel economy'],
    causes: ['Failed sensor', 'Wiring issue', 'Vacuum leak'],
    solution: 'Check sensor voltage. Inspect wiring. Check for boost leaks.',
    parts: ['MAP sensor'],
    tools: ['Multimeter', 'Boost gauge'],
    estimatedTime: '30 min - 1.5 hours',
    estimatedCost: '$30-$200'
  },
  {
    code: 'P0108',
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Intake Air',
    severity: 'warning',
    title: 'MAP Sensor - High Input',
    description: 'Manifold Absolute Pressure sensor reading high.',
    symptoms: ['Reduced power', 'Black smoke'],
    causes: ['Failed sensor', 'Wiring short', 'Turbo overboost'],
    solution: 'Check sensor voltage. Verify boost pressure. Inspect wastegate.',
    parts: ['MAP sensor'],
    tools: ['Multimeter', 'Boost gauge'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$30-$300'
  },
  {
    code: 'P0115',
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Coolant Temperature',
    severity: 'warning',
    title: 'Coolant Temperature Sensor Circuit',
    description: 'Coolant temperature sensor circuit malfunction.',
    symptoms: ['Incorrect temp reading', 'Fan issues', 'Starting problems'],
    causes: ['Failed sensor', 'Wiring fault', 'Connector corrosion'],
    solution: 'Check sensor resistance. Verify wiring. Replace sensor.',
    parts: ['Coolant temp sensor'],
    tools: ['Multimeter', 'Resistance chart'],
    estimatedTime: '30 min - 1 hour',
    estimatedCost: '$20-$100'
  },
  {
    code: 'P0191',
    brand: 'Perkins',
    model: 'Common Rail',
    category: 'Fuel Pressure',
    severity: 'warning',
    title: 'Fuel Rail Pressure Sensor Circuit',
    description: 'Fuel pressure sensor circuit range/performance issue.',
    symptoms: ['Erratic pressure readings', 'Running issues'],
    causes: ['Failed sensor', 'Wiring problem', 'Connector issue'],
    solution: 'Check sensor. Verify wiring. Test with known good sensor.',
    parts: ['Fuel pressure sensor'],
    tools: ['Multimeter', 'Perkins EST'],
    estimatedTime: '30 min - 1.5 hours',
    estimatedCost: '$50-$250'
  },
  {
    code: 'P0201',
    brand: 'Perkins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector Circuit Cylinder 1',
    description: 'Electrical fault in cylinder 1 injector circuit.',
    symptoms: ['Rough idle', 'Misfire', 'Power loss'],
    causes: ['Failed injector', 'Wiring fault', 'ECM driver issue'],
    solution: 'Check injector resistance. Inspect wiring. Test ECM output.',
    parts: ['Injector'],
    tools: ['Multimeter', 'Perkins EST'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$150-$700'
  },
  {
    code: 'P0202',
    brand: 'Perkins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector Circuit Cylinder 2',
    description: 'Electrical fault in cylinder 2 injector circuit.',
    symptoms: ['Rough idle', 'Misfire', 'Power loss'],
    causes: ['Failed injector', 'Wiring fault'],
    solution: 'Diagnose injector circuit. Replace if faulty.',
    parts: ['Injector'],
    tools: ['Multimeter', 'Perkins EST'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$150-$700'
  },
  {
    code: 'P0203',
    brand: 'Perkins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector Circuit Cylinder 3',
    description: 'Electrical fault in cylinder 3 injector circuit.',
    symptoms: ['Rough idle', 'Misfire'],
    causes: ['Failed injector', 'Wiring issue'],
    solution: 'Test and replace injector if needed.',
    parts: ['Injector'],
    tools: ['Multimeter'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$150-$700'
  },
  {
    code: 'P0204',
    brand: 'Perkins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector Circuit Cylinder 4',
    description: 'Electrical fault in cylinder 4 injector circuit.',
    symptoms: ['Rough idle', 'Misfire'],
    causes: ['Failed injector', 'Wiring issue'],
    solution: 'Diagnose and repair injector circuit.',
    parts: ['Injector'],
    tools: ['Multimeter'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$150-$700'
  },
  {
    code: 'P0216',
    brand: 'Perkins',
    model: 'Mechanical Pump',
    category: 'Fuel System',
    severity: 'critical',
    title: 'Injection Timing Fault',
    description: 'Fuel injection timing out of specification.',
    symptoms: ['Hard starting', 'Low power', 'Smoke', 'Knock'],
    causes: ['Pump timing off', 'Timing belt/gear issue', 'Pump failure'],
    solution: 'Check and adjust injection pump timing. Inspect timing components.',
    parts: ['Timing belt/gears', 'Injection pump'],
    tools: ['Timing light', 'Perkins EST'],
    estimatedTime: '2-6 hours',
    estimatedCost: '$200-$2000'
  },
  {
    code: 'P0335',
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Engine Speed',
    severity: 'critical',
    title: 'Crankshaft Position Sensor Circuit',
    description: 'Crankshaft position sensor circuit malfunction.',
    symptoms: ['No start', 'Stalling', 'No RPM signal'],
    causes: ['Failed sensor', 'Wiring damage', 'Tone wheel damage'],
    solution: 'Check sensor and wiring. Verify tone wheel condition.',
    parts: ['Crankshaft position sensor'],
    tools: ['Multimeter', 'Oscilloscope'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$50-$300'
  },
  {
    code: 'P0340',
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Engine Timing',
    severity: 'warning',
    title: 'Camshaft Position Sensor Circuit',
    description: 'Camshaft position sensor circuit malfunction.',
    symptoms: ['Hard starting', 'Rough running', 'Timing issues'],
    causes: ['Failed sensor', 'Wiring issue', 'Cam gear damage'],
    solution: 'Check sensor and wiring. Inspect cam gear.',
    parts: ['Camshaft position sensor'],
    tools: ['Multimeter'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$50-$300'
  },
  {
    code: 'P0380',
    brand: 'Perkins',
    model: 'All Electronic',
    category: 'Cold Start',
    severity: 'warning',
    title: 'Glow Plug Circuit A',
    description: 'Glow plug heating circuit malfunction.',
    symptoms: ['Hard cold starting', 'White smoke on startup'],
    causes: ['Failed glow plug(s)', 'Controller issue', 'Wiring fault'],
    solution: 'Test glow plugs individually. Check controller output.',
    parts: ['Glow plugs', 'Glow plug controller'],
    tools: ['Multimeter', 'Clamp ammeter'],
    estimatedTime: '1-3 hours',
    estimatedCost: '$50-$400'
  },
  {
    code: 'P0401',
    brand: 'Perkins',
    model: 'Tier 4/Stage V',
    category: 'Emissions',
    severity: 'warning',
    title: 'EGR Flow Insufficient',
    description: 'Exhaust Gas Recirculation flow below expected level.',
    symptoms: ['Check engine light', 'Slight power loss'],
    causes: ['EGR valve stuck', 'Carbon buildup', 'Vacuum issue'],
    solution: 'Clean or replace EGR valve. Check vacuum supply.',
    parts: ['EGR valve', 'EGR cooler'],
    tools: ['Perkins EST', 'Vacuum gauge'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$100-$800'
  },
  {
    code: 'P0420',
    brand: 'Perkins',
    model: 'Tier 4/Stage V',
    category: 'Aftertreatment',
    severity: 'warning',
    title: 'Catalyst System Efficiency Below Threshold',
    description: 'Catalytic converter not operating at expected efficiency.',
    symptoms: ['Check engine light', 'Possible failed emissions'],
    causes: ['Catalyst degradation', 'Exhaust leak', 'Sensor fault'],
    solution: 'Check for exhaust leaks. Test O2 sensors. Replace catalyst if needed.',
    parts: ['Catalytic converter', 'O2 sensors'],
    tools: ['Exhaust analyzer', 'Perkins EST'],
    estimatedTime: '1-6 hours',
    estimatedCost: '$200-$2500'
  },
  {
    code: 'P2002',
    brand: 'Perkins',
    model: 'Tier 4/Stage V',
    category: 'Aftertreatment',
    severity: 'warning',
    title: 'DPF Efficiency Below Threshold',
    description: 'Diesel Particulate Filter not meeting efficiency requirements.',
    symptoms: ['DPF light', 'Power derate', 'Frequent regens'],
    causes: ['High soot load', 'DPF damage', 'Failed regen'],
    solution: 'Perform forced regeneration. Clean or replace DPF if needed.',
    parts: ['DPF', 'DPF cleaning service'],
    tools: ['Perkins EST', 'Backpressure gauge'],
    estimatedTime: '2-8 hours',
    estimatedCost: '$200-$3000'
  }
];

// Export count
export const PERKINS_CODE_COUNT = PERKINS_ERROR_CODES.length;
