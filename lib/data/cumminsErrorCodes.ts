/**
 * CUMMINS GENERATOR ERROR CODES DATABASE
 * Comprehensive fault codes for Cummins diesel engines
 * Includes ISX, QSK, QSB, QSL, QSM, 6BT, 6CT, KTA series
 * Updated: January 2026
 */

export interface CumminsErrorCode {
  code: string;
  spn?: number;  // Suspect Parameter Number (J1939)
  fmi?: number;  // Failure Mode Identifier
  brand: 'Cummins';
  model?: string;
  category: string;
  severity: 'info' | 'warning' | 'critical' | 'emergency';
  title: string;
  description: string;
  symptoms: string[];
  causes: string[];
  solution: string;
  parts?: string[];
  tools?: string[];
  estimatedTime?: string;
  estimatedCost?: string;
}

export const CUMMINS_ERROR_CODES: CumminsErrorCode[] = [
  // ===== ENGINE CONTROL MODULE (ECM) CODES 111-199 =====
  {
    code: '111',
    spn: 629,
    fmi: 12,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'ECM',
    severity: 'warning',
    title: 'ECM Internal Hardware Failure',
    description: 'Electronic Control Module has detected an internal hardware fault that may affect performance.',
    symptoms: ['Check engine light on', 'Erratic engine behavior', 'Diagnostic communication issues', 'Limp mode possible'],
    causes: ['Internal ECM circuit failure', 'Power surge damage', 'Water ingress', 'Excessive vibration', 'Age degradation'],
    solution: 'Check ECM power supply (24V±2V). Inspect connectors for corrosion. Clear code and test. If persistent, ECM replacement required.',
    parts: ['ECM unit', 'Connector seals', 'Gaskets'],
    tools: ['Cummins INSITE', 'Digital multimeter', 'Diagnostic adapter'],
    estimatedTime: '1-8 hours',
    estimatedCost: '$100-$3500'
  },
  {
    code: '115',
    spn: 190,
    fmi: 8,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Engine Speed',
    severity: 'critical',
    title: 'Engine Speed Sensor - No Signal',
    description: 'ECM not receiving signal from crankshaft position sensor. Engine will not start or may stall.',
    symptoms: ['Engine cranks no start', 'Sudden stalling', 'No RPM reading', 'No fuel injection'],
    causes: ['Failed speed sensor', 'Wiring damage', 'Sensor gap too large', 'Damaged tone wheel', 'Corroded connector'],
    solution: 'Check sensor resistance (200-900Ω). Verify air gap (0.5-1.5mm). Inspect tone wheel. Check wiring continuity.',
    parts: ['Speed sensor', 'O-ring', 'Wiring harness'],
    tools: ['Multimeter', 'Feeler gauge', 'Inspection mirror'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$80-$300'
  },
  {
    code: '122',
    spn: 102,
    fmi: 3,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Intake Air',
    severity: 'warning',
    title: 'Intake Manifold Pressure Sensor - Voltage High',
    description: 'Boost pressure sensor reading abnormally high voltage. May affect turbo performance.',
    symptoms: ['Reduced power', 'Black smoke', 'Poor fuel economy', 'Turbo surge'],
    causes: ['Failed MAP sensor', 'Wiring short to power', 'Boost leak', 'Turbo overboost'],
    solution: 'Check sensor voltage (0.5-4.5V typical). Inspect wiring for shorts. Check boost hoses for leaks. Test turbo wastegate.',
    parts: ['MAP sensor', 'Boost hoses', 'Clamps'],
    tools: ['Multimeter', 'Boost gauge', 'Smoke machine'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$50-$250'
  },
  {
    code: '123',
    spn: 102,
    fmi: 4,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Intake Air',
    severity: 'warning',
    title: 'Intake Manifold Pressure Sensor - Voltage Low',
    description: 'Boost pressure sensor reading abnormally low voltage. May indicate sensor failure or air restriction.',
    symptoms: ['Reduced power', 'High exhaust temps', 'Turbo not spooling', 'Poor acceleration'],
    causes: ['Failed MAP sensor', 'Wiring open/short to ground', 'Plugged air filter', 'Collapsed intake hose'],
    solution: 'Check sensor voltage. Inspect wiring for opens. Replace air filter. Check intake system for restrictions.',
    parts: ['MAP sensor', 'Air filter', 'Intake hose'],
    tools: ['Multimeter', 'Air filter restriction gauge'],
    estimatedTime: '30 min - 1 hour',
    estimatedCost: '$30-$200'
  },
  {
    code: '131',
    spn: 91,
    fmi: 3,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Throttle',
    severity: 'warning',
    title: 'Accelerator Position Sensor - Voltage High',
    description: 'Throttle position sensor 1 reading high voltage. May cause erratic throttle response.',
    symptoms: ['Engine racing', 'Uncontrolled acceleration', 'Idle surge', 'Throttle not responding'],
    causes: ['Failed TPS', 'Wiring short to power', 'Pedal assembly failure', 'ECM issue'],
    solution: 'Check TPS voltage (0.5-4.5V sweep). Inspect wiring. Test pedal assembly. Check for multiple TPS codes.',
    parts: ['TPS sensor', 'Throttle pedal assembly'],
    tools: ['Multimeter', 'INSITE software'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$50-$400'
  },
  {
    code: '132',
    spn: 91,
    fmi: 4,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Throttle',
    severity: 'warning',
    title: 'Accelerator Position Sensor - Voltage Low',
    description: 'Throttle position sensor 1 reading low voltage. May cause no throttle response.',
    symptoms: ['No throttle response', 'Engine stays at idle', 'Intermittent acceleration', 'Limp mode'],
    causes: ['Failed TPS', 'Wiring open/ground short', 'Pedal connector issue', 'ECM failure'],
    solution: 'Check TPS voltage and wiring. Inspect pedal connector. Clean or replace TPS. Clear codes and test.',
    parts: ['TPS sensor', 'Pedal wiring harness'],
    tools: ['Multimeter', 'Contact cleaner'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$50-$400'
  },
  {
    code: '135',
    spn: 100,
    fmi: 3,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Oil Pressure',
    severity: 'critical',
    title: 'Oil Pressure Sensor - Voltage High',
    description: 'Oil pressure sensor circuit showing high voltage. May mask actual low oil pressure.',
    symptoms: ['Oil pressure gauge maxed', 'Warning light issues', 'Unable to verify oil pressure'],
    causes: ['Failed sensor', 'Wiring short', 'Sensor connector issue', 'ECM input failure'],
    solution: 'Install mechanical gauge to verify actual pressure. Check sensor wiring. Replace sensor if faulty.',
    parts: ['Oil pressure sensor', 'Sensor connector'],
    tools: ['Mechanical pressure gauge', 'Multimeter'],
    estimatedTime: '30 min - 1 hour',
    estimatedCost: '$30-$150'
  },
  {
    code: '141',
    spn: 100,
    fmi: 1,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Oil Pressure',
    severity: 'emergency',
    title: 'Oil Pressure - Low (Engine Protection)',
    description: 'CRITICAL: Engine oil pressure below minimum safe operating level. Immediate shutdown required.',
    symptoms: ['Oil pressure warning', 'Engine knock', 'Engine shutdown', 'Alarm sounding'],
    causes: ['Low oil level', 'Oil pump failure', 'Clogged oil filter', 'Bearing wear', 'Oil leak'],
    solution: 'STOP ENGINE IMMEDIATELY. Check oil level. Inspect for leaks. Do NOT restart until cause identified.',
    parts: ['Engine oil', 'Oil filter', 'Oil pump', 'Bearings'],
    tools: ['Oil pressure gauge', 'Inspection camera'],
    estimatedTime: '1-8+ hours',
    estimatedCost: '$50-$5000+'
  },
  {
    code: '143',
    spn: 100,
    fmi: 4,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Oil Pressure',
    severity: 'warning',
    title: 'Oil Pressure Sensor - Voltage Low',
    description: 'Oil pressure sensor circuit showing low voltage. Sensor may have failed.',
    symptoms: ['Zero oil pressure reading', 'Warning light on', 'Actual pressure unknown'],
    causes: ['Failed sensor', 'Wiring open circuit', 'Ground issue', 'Connector corrosion'],
    solution: 'Verify actual oil pressure with mechanical gauge. Check wiring continuity. Replace sensor.',
    parts: ['Oil pressure sensor'],
    tools: ['Mechanical gauge', 'Multimeter'],
    estimatedTime: '30 min - 1 hour',
    estimatedCost: '$30-$150'
  },
  {
    code: '144',
    spn: 110,
    fmi: 3,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Coolant Temperature',
    severity: 'warning',
    title: 'Coolant Temperature Sensor - Voltage High',
    description: 'Coolant temp sensor showing high voltage (cold reading). May mask actual overheating.',
    symptoms: ['Gauge shows cold', 'Fan may not engage', 'Poor warmup performance'],
    causes: ['Failed sensor', 'Wiring short', 'Connector issue', 'ECM input failure'],
    solution: 'Check actual coolant temp. Verify sensor resistance vs temp chart. Check wiring.',
    parts: ['Coolant temp sensor'],
    tools: ['Multimeter', 'IR thermometer', 'Resistance chart'],
    estimatedTime: '30 min - 1 hour',
    estimatedCost: '$20-$100'
  },
  {
    code: '145',
    spn: 110,
    fmi: 4,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Coolant Temperature',
    severity: 'warning',
    title: 'Coolant Temperature Sensor - Voltage Low',
    description: 'Coolant temp sensor showing low voltage (hot reading). May cause fan to run constantly.',
    symptoms: ['Gauge maxed hot', 'Fan runs constantly', 'Possible derate'],
    causes: ['Failed sensor', 'Wiring short to ground', 'Sensor ground issue'],
    solution: 'Verify actual temperature. Check sensor wiring for shorts. Replace sensor.',
    parts: ['Coolant temp sensor'],
    tools: ['Multimeter', 'IR thermometer'],
    estimatedTime: '30 min - 1 hour',
    estimatedCost: '$20-$100'
  },
  {
    code: '146',
    spn: 110,
    fmi: 0,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Coolant Temperature',
    severity: 'emergency',
    title: 'Coolant Temperature - Very High (Engine Protection)',
    description: 'CRITICAL: Engine coolant temperature dangerously high. Engine damage imminent.',
    symptoms: ['High temp warning', 'Steam/coolant loss', 'Engine derate/shutdown', 'Alarm sounding'],
    causes: ['Low coolant', 'Failed thermostat', 'Blocked radiator', 'Water pump failure', 'Head gasket leak'],
    solution: 'STOP ENGINE. Allow to cool. Check coolant level. Inspect for leaks. Do NOT open hot radiator cap.',
    parts: ['Coolant', 'Thermostat', 'Water pump', 'Radiator', 'Head gasket'],
    tools: ['Pressure tester', 'IR thermometer', 'Block tester'],
    estimatedTime: '1-24+ hours',
    estimatedCost: '$50-$8000+'
  },
  // ===== FUEL SYSTEM CODES 151-199 =====
  {
    code: '151',
    spn: 157,
    fmi: 3,
    brand: 'Cummins',
    model: 'Common Rail',
    category: 'Fuel Pressure',
    severity: 'warning',
    title: 'Fuel Rail Pressure Sensor - Voltage High',
    description: 'Fuel pressure sensor showing high voltage. May cause incorrect fueling.',
    symptoms: ['Rough running', 'Power issues', 'Black smoke', 'Fuel economy changes'],
    causes: ['Failed sensor', 'Wiring short', 'Connector issue', 'High actual fuel pressure'],
    solution: 'Check actual rail pressure. Inspect sensor and wiring. Test fuel system pressure regulator.',
    parts: ['Fuel pressure sensor', 'Fuel pressure regulator'],
    tools: ['Fuel pressure gauge', 'Multimeter', 'INSITE'],
    estimatedTime: '1-3 hours',
    estimatedCost: '$100-$500'
  },
  {
    code: '153',
    spn: 157,
    fmi: 1,
    brand: 'Cummins',
    model: 'Common Rail',
    category: 'Fuel Pressure',
    severity: 'critical',
    title: 'Fuel Rail Pressure - High (Engine Protection)',
    description: 'Fuel rail pressure exceeds safe limits. Risk of injector damage or fuel system failure.',
    symptoms: ['Engine derate', 'Hard running', 'Possible shutdown', 'Injector noise'],
    causes: ['Failed pressure regulator', 'Blocked return line', 'Faulty high pressure pump', 'Sensor error'],
    solution: 'Reduce load immediately. Check fuel return line for blockage. Test pressure regulator. Inspect high pressure pump.',
    parts: ['Fuel pressure regulator', 'High pressure pump', 'Return lines'],
    tools: ['Fuel pressure gauge', 'INSITE diagnostic'],
    estimatedTime: '2-6 hours',
    estimatedCost: '$200-$2000'
  },
  {
    code: '154',
    spn: 157,
    fmi: 18,
    brand: 'Cummins',
    model: 'Common Rail',
    category: 'Fuel Pressure',
    severity: 'critical',
    title: 'Fuel Rail Pressure - Low (Engine Protection)',
    description: 'Fuel rail pressure below minimum required for proper injection. Engine may not run properly.',
    symptoms: ['Low power', 'White smoke', 'Hard starting', 'Engine stumble', 'Stalling'],
    causes: ['Fuel supply restriction', 'Failed lift pump', 'Air in system', 'Blocked filter', 'Worn high pressure pump'],
    solution: 'Check fuel level. Replace fuel filters. Bleed fuel system. Test lift pump pressure (min 30 PSI). Check for air leaks.',
    parts: ['Fuel filters', 'Lift pump', 'High pressure pump', 'Fuel lines'],
    tools: ['Fuel pressure gauge', 'Vacuum gauge', 'INSITE'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$50-$1500'
  },
  {
    code: '155',
    spn: 105,
    fmi: 3,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Intake Temperature',
    severity: 'info',
    title: 'Intake Manifold Temperature Sensor - Voltage High',
    description: 'Intake air temp sensor showing high voltage (cold reading). May affect fuel calculations.',
    symptoms: ['Rich running when hot', 'Slight power variation', 'Fuel economy impact'],
    causes: ['Failed sensor', 'Wiring issue', 'Connector corrosion'],
    solution: 'Check sensor resistance vs temperature. Inspect wiring. Replace sensor if faulty.',
    parts: ['Intake temp sensor'],
    tools: ['Multimeter', 'IR thermometer'],
    estimatedTime: '15-30 min',
    estimatedCost: '$20-$80'
  },
  // ===== ENGINE SPEED/TIMING CODES 221-249 =====
  {
    code: '221',
    spn: 723,
    fmi: 8,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Engine Timing',
    severity: 'critical',
    title: 'Engine Speed/Position Sensor #2 - No Signal',
    description: 'Secondary speed sensor (camshaft) not providing signal. May affect timing and starting.',
    symptoms: ['Hard starting', 'Rough idle', 'Timing issues', 'Power loss'],
    causes: ['Failed cam sensor', 'Wiring damage', 'Sensor gap', 'Cam gear damage', 'ECM issue'],
    solution: 'Check sensor resistance and gap. Inspect cam gear condition. Verify wiring continuity.',
    parts: ['Cam position sensor', 'Wiring'],
    tools: ['Multimeter', 'Feeler gauge', 'INSITE'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$80-$300'
  },
  {
    code: '234',
    spn: 190,
    fmi: 0,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Engine Speed',
    severity: 'emergency',
    title: 'Engine Overspeed (Engine Protection)',
    description: 'CRITICAL: Engine RPM exceeded maximum safe speed. Potential for catastrophic failure.',
    symptoms: ['Engine racing', 'Loud noise', 'Emergency shutdown', 'Alarm sounding'],
    causes: ['Governor failure', 'Actuator stuck', 'Fuel system runaway', 'Load rejection', 'Turbo seal failure (oil ingestion)'],
    solution: 'DO NOT RESTART. Inspect governor and fuel system. Check for turbo oil seal failure. Professional inspection required.',
    parts: ['Governor actuator', 'Turbo seals', 'Fuel system components'],
    tools: ['INSITE diagnostic', 'Mechanical inspection tools'],
    estimatedTime: '4-24+ hours',
    estimatedCost: '$500-$15000+'
  },
  {
    code: '235',
    spn: 110,
    fmi: 16,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Coolant Temperature',
    severity: 'warning',
    title: 'Coolant Temperature - High (Warning)',
    description: 'Engine coolant temperature above normal operating range. Monitor closely.',
    symptoms: ['Temp gauge rising', 'Fan running high', 'Possible power derate'],
    causes: ['Cooling system restriction', 'Low coolant', 'Fan clutch issue', 'High ambient temp', 'High load'],
    solution: 'Reduce load. Check coolant level. Inspect radiator for blockage. Check fan operation. Monitor temp closely.',
    parts: ['Coolant', 'Radiator', 'Fan clutch', 'Thermostat'],
    tools: ['IR thermometer', 'Pressure tester'],
    estimatedTime: '30 min - 4 hours',
    estimatedCost: '$20-$500'
  },
  {
    code: '241',
    spn: 97,
    fmi: 3,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Fuel Filter',
    severity: 'warning',
    title: 'Vehicle Speed Sensor - Signal Abnormal',
    description: 'Vehicle/output speed sensor signal out of range or erratic.',
    symptoms: ['Speedometer issues', 'Cruise control problems', 'Transmission issues'],
    causes: ['Failed sensor', 'Wiring damage', 'Tone ring damage', 'Connector issue'],
    solution: 'Check sensor output signal. Inspect wiring and connector. Verify tone ring condition.',
    parts: ['Speed sensor'],
    tools: ['Multimeter', 'Oscilloscope'],
    estimatedTime: '30 min - 1.5 hours',
    estimatedCost: '$50-$200'
  },
  // ===== INJECTOR CODES 251-299 =====
  {
    code: '251',
    spn: 651,
    fmi: 5,
    brand: 'Cummins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector #1 Circuit - Open/Short',
    description: 'Electrical fault detected in cylinder 1 injector circuit.',
    symptoms: ['Rough idle', 'Misfire', 'Power loss', 'Smoke from cylinder 1'],
    causes: ['Failed injector solenoid', 'Wiring damage', 'Connector corrosion', 'ECM driver failure'],
    solution: 'Check injector resistance (varies by type). Inspect wiring harness. Test ECM driver output.',
    parts: ['Injector', 'Wiring harness', 'Connector'],
    tools: ['Multimeter', 'INSITE', 'Noid light'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$200-$800'
  },
  {
    code: '252',
    spn: 652,
    fmi: 5,
    brand: 'Cummins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector #2 Circuit - Open/Short',
    description: 'Electrical fault detected in cylinder 2 injector circuit.',
    symptoms: ['Rough idle', 'Misfire', 'Power loss', 'Smoke from cylinder 2'],
    causes: ['Failed injector solenoid', 'Wiring damage', 'Connector corrosion', 'ECM driver failure'],
    solution: 'Check injector resistance. Inspect wiring. Compare to cylinder 1 readings.',
    parts: ['Injector', 'Wiring harness'],
    tools: ['Multimeter', 'INSITE'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$200-$800'
  },
  {
    code: '253',
    spn: 653,
    fmi: 5,
    brand: 'Cummins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector #3 Circuit - Open/Short',
    description: 'Electrical fault detected in cylinder 3 injector circuit.',
    symptoms: ['Rough idle', 'Misfire', 'Power loss'],
    causes: ['Failed injector', 'Wiring fault', 'Connector issue'],
    solution: 'Check injector circuit. Inspect wiring. Replace injector if faulty.',
    parts: ['Injector'],
    tools: ['Multimeter', 'INSITE'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$200-$800'
  },
  {
    code: '254',
    spn: 654,
    fmi: 5,
    brand: 'Cummins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector #4 Circuit - Open/Short',
    description: 'Electrical fault detected in cylinder 4 injector circuit.',
    symptoms: ['Rough idle', 'Misfire', 'Power loss'],
    causes: ['Failed injector', 'Wiring fault', 'Connector issue'],
    solution: 'Check injector circuit. Compare to other cylinders.',
    parts: ['Injector'],
    tools: ['Multimeter', 'INSITE'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$200-$800'
  },
  {
    code: '255',
    spn: 655,
    fmi: 5,
    brand: 'Cummins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector #5 Circuit - Open/Short',
    description: 'Electrical fault detected in cylinder 5 injector circuit.',
    symptoms: ['Rough idle', 'Misfire', 'Power loss'],
    causes: ['Failed injector', 'Wiring fault'],
    solution: 'Diagnose injector circuit. Replace if necessary.',
    parts: ['Injector'],
    tools: ['Multimeter', 'INSITE'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$200-$800'
  },
  {
    code: '256',
    spn: 656,
    fmi: 5,
    brand: 'Cummins',
    model: 'Common Rail',
    category: 'Injectors',
    severity: 'critical',
    title: 'Injector #6 Circuit - Open/Short',
    description: 'Electrical fault detected in cylinder 6 injector circuit.',
    symptoms: ['Rough idle', 'Misfire', 'Power loss'],
    causes: ['Failed injector', 'Wiring fault'],
    solution: 'Diagnose and repair injector circuit.',
    parts: ['Injector'],
    tools: ['Multimeter', 'INSITE'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$200-$800'
  },
  // ===== TURBOCHARGER CODES 271-299 =====
  {
    code: '271',
    spn: 102,
    fmi: 16,
    brand: 'Cummins',
    model: 'Turbocharged',
    category: 'Turbocharger',
    severity: 'warning',
    title: 'Turbo Boost Pressure - Low',
    description: 'Turbo boost pressure below expected levels. Engine power will be reduced.',
    symptoms: ['Low power', 'Black smoke', 'Slow acceleration', 'High EGT'],
    causes: ['Boost leak', 'Turbo failure', 'Wastegate stuck open', 'Plugged air filter', 'Exhaust restriction'],
    solution: 'Check boost hoses and clamps. Test turbo shaft play. Check air filter. Inspect exhaust for restrictions.',
    parts: ['Boost hoses', 'Clamps', 'Air filter', 'Turbocharger'],
    tools: ['Boost gauge', 'Smoke machine'],
    estimatedTime: '1-6 hours',
    estimatedCost: '$50-$2500'
  },
  {
    code: '272',
    spn: 102,
    fmi: 0,
    brand: 'Cummins',
    model: 'Turbocharged',
    category: 'Turbocharger',
    severity: 'critical',
    title: 'Turbo Boost Pressure - Very High',
    description: 'Turbo boost pressure exceeds safe limits. Risk of engine damage.',
    symptoms: ['Excessive power', 'Turbo whine', 'Possible engine knock', 'Black smoke'],
    causes: ['Wastegate stuck closed', 'Failed wastegate actuator', 'Boost controller fault', 'Incorrect calibration'],
    solution: 'Check wastegate operation. Test actuator. Verify boost controller. Reduce load until fixed.',
    parts: ['Wastegate actuator', 'Boost controller', 'Turbocharger'],
    tools: ['Boost gauge', 'INSITE', 'Hand vacuum pump'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$100-$1500'
  },
  // ===== COMMUNICATION CODES 319-399 =====
  {
    code: '319',
    spn: 639,
    fmi: 9,
    brand: 'Cummins',
    model: 'All J1939',
    category: 'Communication',
    severity: 'warning',
    title: 'J1939 Datalink - Abnormal Update Rate',
    description: 'CAN bus communication experiencing errors or abnormal message rates.',
    symptoms: ['Gauge flickering', 'Intermittent warnings', 'Communication errors'],
    causes: ['CAN bus wiring issue', 'Terminating resistor problem', 'ECM communication issue', 'Other module interference'],
    solution: 'Check CAN bus wiring. Verify terminating resistors (120Ω). Disconnect modules one at a time to isolate.',
    parts: ['CAN terminating resistors', 'Wiring'],
    tools: ['Multimeter', 'CAN analyzer', 'INSITE'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$50-$300'
  },
  {
    code: '351',
    spn: 168,
    fmi: 4,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Electrical',
    severity: 'warning',
    title: 'Battery Voltage - Low',
    description: 'Battery voltage below minimum required for proper ECM operation.',
    symptoms: ['Hard starting', 'Gauge issues', 'ECM reset', 'Intermittent codes'],
    causes: ['Weak batteries', 'Charging system issue', 'Excessive parasitic draw', 'Loose connections'],
    solution: 'Load test batteries. Check alternator output. Inspect battery cables and connections.',
    parts: ['Batteries', 'Alternator', 'Cables'],
    tools: ['Load tester', 'Multimeter', 'Ammeter'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$100-$500'
  },
  {
    code: '352',
    spn: 168,
    fmi: 3,
    brand: 'Cummins',
    model: 'All Electronic',
    category: 'Electrical',
    severity: 'warning',
    title: 'Battery Voltage - High',
    description: 'Battery voltage above normal. May damage electronics.',
    symptoms: ['Bulb burnout', 'ECM issues', 'Battery boiling', 'Electrical smell'],
    causes: ['Overcharging alternator', 'Failed voltage regulator', 'Wrong battery type'],
    solution: 'Check alternator output (should be 27-29V for 24V system). Replace regulator if necessary.',
    parts: ['Voltage regulator', 'Alternator'],
    tools: ['Multimeter'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$50-$400'
  },
  // ===== AFTERTREATMENT CODES 411-499 =====
  {
    code: '411',
    spn: 4094,
    fmi: 18,
    brand: 'Cummins',
    model: 'EPA Tier 4/Euro 6',
    category: 'Aftertreatment',
    severity: 'warning',
    title: 'SCR NOx Conversion - Low',
    description: 'Selective Catalytic Reduction system not achieving required NOx conversion efficiency.',
    symptoms: ['Check engine light', 'Power derate', 'DEF consumption change'],
    causes: ['Low DEF quality', 'SCR catalyst degraded', 'DEF dosing issue', 'Exhaust temp too low'],
    solution: 'Check DEF quality (32.5% urea). Verify DEF dosing. Check SCR inlet temp. May need catalyst replacement.',
    parts: ['DEF fluid', 'DEF injector', 'SCR catalyst'],
    tools: ['DEF refractometer', 'INSITE', 'IR thermometer'],
    estimatedTime: '1-8 hours',
    estimatedCost: '$50-$5000'
  },
  {
    code: '415',
    spn: 3364,
    fmi: 18,
    brand: 'Cummins',
    model: 'EPA Tier 4/Euro 6',
    category: 'Aftertreatment',
    severity: 'warning',
    title: 'DEF Tank Level - Low',
    description: 'Diesel Exhaust Fluid level low. Engine will derate if not refilled.',
    symptoms: ['DEF warning light', 'Level gauge low', 'Upcoming derate warning'],
    causes: ['Normal consumption', 'Leak in DEF system', 'Faulty level sensor'],
    solution: 'Refill DEF tank with API certified fluid. If level drops quickly, check for leaks.',
    parts: ['DEF fluid'],
    tools: ['DEF refractometer'],
    estimatedTime: '10-30 min',
    estimatedCost: '$15-$50'
  },
  {
    code: '419',
    spn: 4334,
    fmi: 1,
    brand: 'Cummins',
    model: 'EPA Tier 4/Euro 6',
    category: 'Aftertreatment',
    severity: 'warning',
    title: 'DEF Quality - Poor',
    description: 'DEF fluid quality does not meet requirements. System may not function properly.',
    symptoms: ['DEF warning', 'Reduced NOx conversion', 'Derate warning'],
    causes: ['Contaminated DEF', 'Diluted DEF', 'Wrong fluid used', 'Expired DEF'],
    solution: 'Drain and flush DEF tank. Refill with fresh API certified DEF. Run regeneration if needed.',
    parts: ['Fresh DEF fluid'],
    tools: ['DEF refractometer'],
    estimatedTime: '1-2 hours',
    estimatedCost: '$50-$200'
  },
  {
    code: '422',
    spn: 4360,
    fmi: 5,
    brand: 'Cummins',
    model: 'DPF Equipped',
    category: 'Aftertreatment',
    severity: 'warning',
    title: 'DPF Pressure - High (Soot Load)',
    description: 'Diesel Particulate Filter soot loading above normal. Regeneration needed.',
    symptoms: ['DPF light on', 'Power reduction', 'Regen request', 'High exhaust backpressure'],
    causes: ['Extended idle operation', 'Short trip operation', 'Failed regeneration', 'DPF damage'],
    solution: 'Perform parked regeneration if safe. If unsuccessful, may need forced regen with INSITE or DPF cleaning.',
    parts: ['DPF cleaning service', 'DPF replacement'],
    tools: ['INSITE', 'DPF pressure gauge'],
    estimatedTime: '1-8 hours',
    estimatedCost: '$200-$3000'
  },
  {
    code: '423',
    spn: 3251,
    fmi: 0,
    brand: 'Cummins',
    model: 'DPF Equipped',
    category: 'Aftertreatment',
    severity: 'critical',
    title: 'DPF Outlet Temperature - Very High',
    description: 'CAUTION: DPF outlet temperature extremely high during regeneration.',
    symptoms: ['Very hot exhaust', 'Temperature warnings', 'Fire risk warning'],
    causes: ['Active regeneration in progress', 'Excessive soot burn-off', 'Temp sensor error'],
    solution: 'Ensure vehicle is in safe location away from combustibles. Allow regen to complete. Check for abnormal temps.',
    parts: ['Temperature sensor'],
    tools: ['IR thermometer', 'INSITE'],
    estimatedTime: '30 min monitoring',
    estimatedCost: '$0-$200'
  },
  // ===== COMMON POWERCOMMAND/GENSET CODES 500-599 =====
  {
    code: '511',
    spn: 190,
    fmi: 2,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Control',
    severity: 'critical',
    title: 'Genset Overcrank - Fail to Start',
    description: 'Generator failed to start after maximum crank attempts.',
    symptoms: ['Engine cranks but no start', 'Fault light on', 'Start sequence stops'],
    causes: ['No fuel', 'Air in fuel system', 'No spark/glow', 'Safety interlock active', 'Dead battery'],
    solution: 'Check fuel supply and level. Bleed fuel system. Check battery voltage. Verify all safety interlocks.',
    parts: ['Fuel filters', 'Batteries', 'Glow plugs'],
    tools: ['Multimeter', 'Fuel pressure gauge'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$50-$500'
  },
  {
    code: '521',
    spn: 190,
    fmi: 0,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Control',
    severity: 'emergency',
    title: 'Genset Overspeed Shutdown',
    description: 'Generator shut down due to engine overspeed condition.',
    symptoms: ['Engine running fast before shutdown', 'Overspeed fault', 'Emergency shutdown'],
    causes: ['Governor failure', 'Fuel system runaway', 'Load rejection', 'Speed sensing error'],
    solution: 'Do NOT restart without inspection. Check governor. Verify speed sensor. Professional inspection required.',
    parts: ['Governor', 'Speed sensor'],
    tools: ['Tachometer', 'INSITE'],
    estimatedTime: '2-8 hours',
    estimatedCost: '$200-$2000'
  },
  {
    code: '531',
    spn: 110,
    fmi: 0,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Control',
    severity: 'emergency',
    title: 'Genset High Engine Temperature Shutdown',
    description: 'Generator shut down due to engine overheating.',
    symptoms: ['High temp warning', 'Shutdown', 'Possible coolant loss'],
    causes: ['Low coolant', 'Blocked radiator', 'Fan failure', 'Thermostat stuck', 'High load/ambient'],
    solution: 'Allow to cool. Check coolant level. Inspect radiator. Check fan operation. Do NOT restart until cause fixed.',
    parts: ['Coolant', 'Thermostat', 'Fan belt', 'Water pump'],
    tools: ['IR thermometer', 'Pressure tester'],
    estimatedTime: '1-6 hours',
    estimatedCost: '$50-$1000'
  },
  {
    code: '541',
    spn: 100,
    fmi: 1,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Control',
    severity: 'emergency',
    title: 'Genset Low Oil Pressure Shutdown',
    description: 'Generator shut down due to low engine oil pressure.',
    symptoms: ['Low oil pressure warning', 'Emergency shutdown', 'Alarm sounding'],
    causes: ['Low oil level', 'Oil pump failure', 'Oil leak', 'Bearing wear', 'Wrong oil viscosity'],
    solution: 'CRITICAL: Check oil level immediately. Look for leaks. Do NOT restart until cause identified.',
    parts: ['Engine oil', 'Oil filter', 'Oil pump', 'Gaskets'],
    tools: ['Oil pressure gauge', 'Inspection camera'],
    estimatedTime: '1-8+ hours',
    estimatedCost: '$50-$5000+'
  },
  {
    code: '545',
    spn: 94,
    fmi: 1,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Control',
    severity: 'warning',
    title: 'Genset Low Fuel Level Warning',
    description: 'Generator fuel level below warning threshold.',
    symptoms: ['Low fuel light', 'Fuel gauge low', 'Warning alarm'],
    causes: ['Normal consumption', 'Fuel leak', 'Faulty sender'],
    solution: 'Refill fuel tank. Check for leaks. Verify fuel sender operation.',
    parts: ['Fuel', 'Fuel sender'],
    tools: ['None for refuel'],
    estimatedTime: '10-30 min',
    estimatedCost: 'Fuel cost'
  },
  {
    code: '551',
    spn: 79,
    fmi: 3,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Output',
    severity: 'critical',
    title: 'Genset AC Over Voltage',
    description: 'Generator AC output voltage exceeds safe limits.',
    symptoms: ['High voltage reading', 'Load equipment tripping', 'Flickering lights'],
    causes: ['AVR failure', 'Sensing circuit fault', 'Speed too high', 'AVR adjustment needed'],
    solution: 'Check engine speed. Verify AVR settings. Test voltage sensing circuit. Adjust or replace AVR.',
    parts: ['AVR', 'Voltage sensing components'],
    tools: ['True RMS multimeter', 'Tachometer'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$100-$800'
  },
  {
    code: '552',
    spn: 79,
    fmi: 4,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Output',
    severity: 'critical',
    title: 'Genset AC Under Voltage',
    description: 'Generator AC output voltage below minimum required.',
    symptoms: ['Low voltage reading', 'Motors struggling', 'Dim lights', 'Equipment not starting'],
    causes: ['AVR failure', 'Loss of excitation', 'Overload', 'Engine speed low', 'Brush wear'],
    solution: 'Check load level. Verify engine speed. Check excitation system. Inspect brushes and slip rings.',
    parts: ['AVR', 'Brushes', 'Excitation diodes'],
    tools: ['Multimeter', 'Tachometer'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$50-$800'
  },
  {
    code: '553',
    spn: 175,
    fmi: 0,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Output',
    severity: 'critical',
    title: 'Genset Over Frequency',
    description: 'Generator frequency exceeds safe limits (>62Hz for 60Hz system).',
    symptoms: ['High frequency alarm', 'Motor overspeeding', 'Equipment damage risk'],
    causes: ['Engine overspeed', 'Governor issue', 'Speed control failure'],
    solution: 'Check engine speed. Verify governor operation. Adjust speed control.',
    parts: ['Governor', 'Speed control module'],
    tools: ['Frequency meter', 'Tachometer'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$50-$500'
  },
  {
    code: '554',
    spn: 175,
    fmi: 1,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Output',
    severity: 'critical',
    title: 'Genset Under Frequency',
    description: 'Generator frequency below minimum required (<58Hz for 60Hz system).',
    symptoms: ['Low frequency alarm', 'Motors running slow', 'Equipment not functioning'],
    causes: ['Engine underspeed', 'Overload', 'Fuel delivery issue', 'Governor failure'],
    solution: 'Reduce load. Check fuel system. Verify governor settings. Check for mechanical binding.',
    parts: ['Governor', 'Fuel system components'],
    tools: ['Frequency meter', 'Fuel pressure gauge'],
    estimatedTime: '30 min - 3 hours',
    estimatedCost: '$50-$800'
  },
  {
    code: '555',
    spn: 521,
    fmi: 5,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Generator Output',
    severity: 'critical',
    title: 'Genset Overcurrent - Phase A',
    description: 'Generator Phase A current exceeds rated capacity.',
    symptoms: ['Overcurrent alarm', 'Circuit breaker trip', 'Overload warning'],
    causes: ['Overload condition', 'Short circuit', 'Phase imbalance', 'Motor starting inrush'],
    solution: 'Reduce load. Check for shorts. Balance loads across phases. Size starting loads correctly.',
    parts: ['Load cables', 'Circuit breakers'],
    tools: ['Clamp ammeter', 'Power analyzer'],
    estimatedTime: '30 min - 2 hours',
    estimatedCost: '$0-$300'
  },
  {
    code: '561',
    spn: 639,
    fmi: 2,
    brand: 'Cummins',
    model: 'PowerCommand',
    category: 'Communication',
    severity: 'warning',
    title: 'Genset Control Communication Error',
    description: 'Communication error between genset controller and engine ECM.',
    symptoms: ['Parameter display issues', 'Intermittent faults', 'Control issues'],
    causes: ['CAN bus wiring', 'Connector issue', 'EMI interference', 'Module failure'],
    solution: 'Check CAN bus connections. Verify terminating resistors. Shield wiring from EMI sources.',
    parts: ['CAN bus cable', 'Terminating resistors'],
    tools: ['Multimeter', 'CAN analyzer'],
    estimatedTime: '1-4 hours',
    estimatedCost: '$50-$400'
  }
];

// Get all Cummins codes
export function getCumminsCodeByNumber(codeNumber: string): CumminsErrorCode | undefined {
  return CUMMINS_ERROR_CODES.find(code => code.code === codeNumber);
}

// Search Cummins codes
export function searchCumminsCodes(query: string): CumminsErrorCode[] {
  const lowerQuery = query.toLowerCase();
  return CUMMINS_ERROR_CODES.filter(code => 
    code.code.toLowerCase().includes(lowerQuery) ||
    code.title.toLowerCase().includes(lowerQuery) ||
    code.description.toLowerCase().includes(lowerQuery) ||
    code.symptoms.some(s => s.toLowerCase().includes(lowerQuery)) ||
    code.category.toLowerCase().includes(lowerQuery)
  );
}

// Get codes by category
export function getCumminsCodesByCategory(category: string): CumminsErrorCode[] {
  return CUMMINS_ERROR_CODES.filter(code => 
    code.category.toLowerCase() === category.toLowerCase()
  );
}

// Get codes by severity
export function getCumminsCodesBySeverity(severity: CumminsErrorCode['severity']): CumminsErrorCode[] {
  return CUMMINS_ERROR_CODES.filter(code => code.severity === severity);
}

// Export count for stats
export const CUMMINS_CODE_COUNT = CUMMINS_ERROR_CODES.length;
